## Last changed: 2024-03-15 12:32:46 UTC
version 23.2R1.14;
groups {
    mist-script {
        system {
            scripts {
                op {
                    file mist_helper.py {
                        arguments {
                            cmd;
                        }
                        checksum sha-256 75a45adbab507357152d68b6d5b8d3171cd69c37d2842e404802ed03b2183c05;
                    }
                    file mist_vccmd.py {
                        checksum sha-256 b4012cfbaa9ed42b776fa96d016dd9d1036ebe1a5706ede49567db366d5f5e4b;
                    }
                    file mist_pyagent_tools.py {
                        arguments {
                            cmd;
                            sha256sum;
                            url;
                            version;
                        }
                        checksum sha-256 e4f6b45db810817dc5a7e912808616fe15373c74c310d74e8efdc7184b966714;
                    }
                }
            }
        }
        event-options {
            generate-event {
                get-stats-every-three-minute time-interval 180;
                monitor-diskspace-now time-interval 86400;
            }
            policy log-on-snmp-trap-link-up {
                events snmp_trap_link_up;
                within 90 {
                    not events chassisd_vchassis_member_update_notice;
                }
                attributes-match {
                    "{$$.interface-name}" matches "^[^.]+$";
                }
                then {
                    event-script mist_link_up_logger.py;
                }
            }
            policy log-on-snmp-trap-link-down {
                events snmp_trap_link_down;
                within 90 {
                    not events chassisd_vchassis_member_update_notice;
                }
                attributes-match {
                    "{$$.interface-name}" matches "^[^.]+$";
                }
                then {
                    event-script mist_link_down_logger.py;
                }
            }
            policy backup-cfg-after-commit {
                events ui_commit_completed;
                within 5 {
                    trigger on 1;
                }
                then {
                    event-script mist_event_dispatcher.py;
                }
            }
            policy backup-cfg-after-no-confirmed {
                events ui_commit_not_confirmed;
                attributes-match {
                    ui_commit_not_confirmed.message matches .*complete;
                }
                then {
                    event-script mist_event_dispatcher.py;
                }
            }
            policy log-on-storm-ctrl-in-effect {
                events l2ald_st_ctl_in_effect;
                then {
                    event-script mist_storm_control_event_logger.py;
                }
            }
            policy log-on-system-events {
                events [ dot1xd_auth_session_deleted dot1xd_rcvd_eaplogof_athntictd dot1xd_usr_access_denied dot1xd_usr_authenticated dot1xd_usr_session_disconnected dot1xd_usr_athntictd_gst_vlan eswd_stp_state_change_info l2cpd_receive_bpdu_block_enabled authd_radius_server_status_change chassisd_snmp_trap10 ddos_protocol_violation_set ddos_protocol_violation_clear evpn_bgp_peer_status_change evpn_core_isolated evpn_core_isolation_cleared evpn_duplicate_mac ];
                within 60 {
                    trigger until 10;
                }
                then {
                    event-script mist_event_dispatcher.py;
                }
            }
            policy log-critical-system-events {
                events [ chassisd_vchassis_member_update_notice chassisd_vchassis_member_op_notice snmpd_trap_cold_start ];
                then {
                    event-script mist_event_dispatcher.py;
                }
            }
            policy monitor-diskspace-policy {
                events monitor-diskspace-now;
                then {
                    event-script mist_monitor_diskspace.py;
                }
            }
            policy get-stats-policy {
                events get-stats-every-three-minute;
                then {
                    event-script mist_event_dispatcher.py;
                }
            }
            policy system-srx-route-events {
                events [ rpd_ospf_nbrdown rpd_ospf_nbrup rpd_bgp_neighbor_state_changed ];
                then {
                    event-script mist_srx_rt_event.py;
                }
            }
            policy log-on-vccp-port-up {
                events vccpd_protocol_adjup;
                attributes-match {
                    "{$$.interface-name}" matches "^[^.]+";
                }
                then {
                    event-script mist_link_up_logger.py;
                }
            }
            policy log-on-vccp-port-down {
                events vccpd_protocol_adjdown;
                attributes-match {
                    "{$$.interface-name}" matches "^[^.]+";
                }
                then {
                    event-script mist_link_down_logger.py;
                }
            }
            event-script {
                file mist_event_dispatcher.py {
                    python-script-user mist;
                    checksum sha-256 f3a043ed02c99898c77ca2d82cb8e55b4bdd7ac12edc624c1cead31eebba436b;
                }
                file mist_link_up_logger.py {
                    python-script-user mist;
                    checksum sha-256 92f3090ff5fa38343e958f64ca7d03d12dcffffa2dbff25bb47f4f77a712d641;
                }
                file mist_link_down_logger.py {
                    python-script-user mist;
                    checksum sha-256 47c2f4b0c575b2a8ead65c36ef451c7705f0b040c7c1085dd443c7a5ac7a2153;
                }
                file mist_backup_cfg.py {
                    python-script-user mist;
                    checksum sha-256 f7bf71e008e29ad04744c11ecb582fb252111842615ff2177f68cf41ddc64daf;
                }
                file mist_storm_control_event_logger.py {
                    python-script-user mist;
                    checksum sha-256 871b7efa4fe7d04d86034fcdcb63624c675956d7511b2a45ebb98299632be882;
                }
                file mist_link_event_capturer.py {
                    python-script-user mist;
                    checksum sha-256 0c07398a84cc947198659a9cbcddbc209f9e3ceda054b34a4ea485de8f35ef9b;
                }
                file mist_monitor_diskspace.py {
                    python-script-user mist;
                    checksum sha-256 c0c54a4ff2d8f67c14be3b35d2df047c72a83ae163ec05ab0263cb04ca11309c;
                }
                file mist_dynamic_port_usages.py {
                    python-script-user mist;
                    checksum sha-256 33dac37c531e9571ac1a2794a2a88e3d0068487f9bf4a12f402dc98dd7c903f5;
                }
                file mist_dynamic_port_commit.py {
                    python-script-user mist;
                    checksum sha-256 4fb25037a8ec5d57ac72f622c005baec2ab82b4f1e1a218f8eac03f6b39e71de;
                }
                file mist_event_aggregator.py {
                    python-script-user mist;
                    checksum sha-256 ca1426d833eddb1f519e7a5860cef6fedd08a2d091656add0537aceaf7a9eb7d;
                }
                file mist_vcsetup_agent.py {
                    python-script-user mist;
                    checksum sha-256 c336e83f4233c3287fd2f78596261f414603350927f75a10bd327ece41832a1f;
                }
                file mist_ssr.py {
                    python-script-user mist;
                    checksum sha-256 4b4a7b079fd20c54d732fa874add9702faaf94fe0798ee7d7abe5c407327afa5;
                }
                file mist_srx_rt_event.py {
                    python-script-user mist;
                    checksum sha-256 dd6fc6d40fed12444a264139ac3825461c3309d243f3176595d9d535ad37a384;
                }
            }
        }
    }
    mist-dpc {
        event-options {
            generate-event {
                timer-every-one-minute time-interval 60;
            }
            policy dynamic-port-detect {
                events [ lldp_neighbor_up snmp_trap_link_up snmp_trap_link_down ui_commit_completed dot1xd_usr_authenticated get-stats-every-three-minute ];
                within 90 {
                    not events chassisd_vchassis_member_update_notice;
                }
                then {
                    event-script mist_dynamic_port_usages.py;
                }
            }
            policy dynamic-port-commit {
                events timer-every-one-minute;
                then {
                    event-script mist_dynamic_port_commit.py;
                }
            }
        }
    }
    evpn_uplink {
        interfaces {
            <*> {
                mtu 9192;
            }
        }
    }
    vlan101 {
        interfaces {
            <*> {
                unit 0 {
                    family ethernet-switching {
                        vlan {
                            members vlan101;
                        }
                    }
                }
            }
        }
    }
    top {
        system {
            commit no-delta-synchronize;
            name-server {
                10.49.32.95;
                10.49.32.97;
            }
            ntp {
                server 66.129.233.81;
            }
        }
        interfaces {
            lo0 {
                unit 0 {
                    family inet {
                        address 172.16.254.5/32;
                    }
                }
                unit 1 {
                    family inet {
                        address 172.16.192.3/32;
                    }
                }
            }
        }
        forwarding-options {
            storm-control-profiles default {
                all;
            }
        }
        policy-options {
            policy-statement ecmp_policy {
                then {
                    load-balance per-packet;
                    accept;
                }
            }
            policy-statement evpn_underlay_export {
                term 01-loopback {
                    from {
                        route-filter 172.16.254.0/23 orlonger;
                    }
                    then accept;
                }
                term 02-default {
                    then reject;
                }
            }
            policy-statement evpn_underlay_import {
                term 01-loopback {
                    from {
                        route-filter 172.16.254.0/23 orlonger;
                    }
                    then accept;
                }
                term 02-default {
                    then reject;
                }
            }
        }
        routing-instances {
            RZ1 {
                instance-type vrf;
                routing-options {
                    multipath;
                    auto-export;
                }
                protocols {
                    evpn {
                        ip-prefix-routes {
                            advertise direct-nexthop;
                            encapsulation vxlan;
                            vni 12183802;
                        }
                    }
                }
                forwarding-options {
                    dhcp-relay {
                        forward-only;
                        server-group {
                            vlan101 {
                                192.168.150.10;
                            }
                        }
                        group vlan101 {
                            active-server-group vlan101;
                            overrides {
                                relay-source lo0.1;
                            }
                            relay-option-82 {
                                circuit-id {
                                    vlan-id-only;
                                }
                                server-id-override;
                            }
                            route-suppression {
                                destination;
                            }
                            interface irb.101;
                        }
                    }
                }
                interface irb.101;
                interface lo0.1;
                route-distinguisher 172.16.254.5:101;
                vrf-target target:65000:101;
                vrf-table-label;
            }
            evpn_vs {
                instance-type virtual-switch;
                protocols {
                    evpn {
                        encapsulation vxlan;
                        default-gateway do-not-advertise;
                        extended-vni-list all;
                    }
                    rstp {
                        bpdu-block-on-edge;
                    }
                }
                vtep-source-interface lo0.0;
                interface ge-0/0/2.0;
                interface ge-0/0/3.0;
                route-distinguisher 172.16.254.5:1;
                vrf-target target:65000:1;
                vlans {
                    vlan101 {
                        vlan-id 101;
                        l3-interface irb.101;
                        vxlan {
                            vni 10101;
                        }
                    }
                }
            }
        }
        routing-options {
            router-id 172.16.254.5;
            autonomous-system 65005;
            forwarding-table {
                export ecmp_policy;
            }
        }
    }
}
apply-groups [ mist-script top ];
/*
 * dhcpd-generated /var/etc/dhcpd.options.conf
 * Version: JDHCPD release 23.2R1.14 built by builder on 2023-06-22 13:29:09 UTC
 * Written: Fri Mar 15 06:14:19 2024
 */
system {
    host-name access1;
    root-authentication {
        encrypted-password "$6$yNYLtvYmgm3zlteX$jMWtZ/Dck.gGMtmiWT26vR4iDJZ/cNeV.Z0hNOUQ/UOYvQyE/lWiskq.0xYIHBKKvEzCjqdNODrI8cw.1Dc0D1"; ## SECRET-DATA
    }
    commit synchronize;
    scripts {
        language python3;
        synchronize;
    }
    login {
        user admin {
            uid 2000;
            class super-user;
            authentication {
                encrypted-password "$1$LFWuw1ls$xFaTbnvBMqcE105iWviOA0"; ## SECRET-DATA
                ssh-rsa "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDBUA+4YJwqE2rqwweZ3NG7GpXF3JqIxFbnDxraW8//QWjHLGVgn+jFbXFB3T/yLYpIRAh8SsAw6M6pZXzGd3oiltENLkoN5YGI1yW0bCTsS/Z4BoW/iuPR2rYQqhA+NPi9OZO/opVbJ+VIdfm+fugWPSVpduBiJN20P9iEF1zCW4EmWZn3qkl25LjVSBVMiwn+crcsCHUub3xDRicgTOOINFo4lZy03Fsa3PoqpxXv18FhNi3pVWmV2n3vIckWt8BbaPWMTFZmERHkVb4Y15GsHwcQxb6gm3h8Do4QgURbujCUJQhpJT4BRdD8kja1NQK4lbcPq6l9rF3YM7aQkscB16nCplWcgdnxI7eN//FA4ovvx7d57i43Y7GzSlQE87kcIDDQ1eCesYOfg9EfqCFSVWV0hbhc2Ap6YCoc0R9POpG1n0LO+o++h0J0bkLUWsIiQLb3LiC91FnP3giK5MEzdJ+maJcjIyGlTth52s01nLdT4gQDgTURqIpfL8L0HWE= irzan@irzan-mbp"; ## SECRET-DATA
            }
        }
        user mist {
            full-name mist;
            uid 63157;
            class super-user;
            authentication {
                encrypted-password "$6$NrqTX/KF4.9FmUb5$xvQrm1qW1Ys1cVuvB72Ett9lU4NWjs.hlgTqrHh1/odF9sZQ2At6M97hdVr54SzabJFyAAdC6jdfbL1HYdzAb0"; ## SECRET-DATA
                ssh-rsa "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDHxLrKfE/EOTYUrho+u9j0roJJqFncfTAQiMpL7zxh4Wn4tG9BdfG924SuPOXfRm6fyVo0O3ulHF+IbWa69SttlGfHC0X01dQb/tUgNv/7mOfJenMWxleYCppgbH2o+SxdTKPXP78fYFNVYbGByOmHPU0iKiPO4YGHi+XEiHqY4XiYLtrmtSDv60rPirXywbEbY1Hmi19qLImnJ1ungbY/IpSC4com5DOrQdZ55DxxgJbRyvofr9V8vlgeSSlrT/FqnK9b52raW7ov1hFPlSE4z9O/m7DixX05B2GJtB0n17HUWDjwR0w1EBLSDpjhJYB8C32DDx+dX8DA6BEmDfqZVekAbr97plkiGpfdD4cyWtfFqqBFhGCketQAFOvfVGyA1PQ6cW9Yr5QAE54qR1Y4nM5UtxDTCxWJCiRwtcshuO269e8a9loukN+WfWwAQPVHrVXs/ksx9TR0I/3W+lqnOoiCeCl7tTkwkVYdp3i59AErXOnuMF24bl64wGw8EUM= mist@2a10e8b3-060c-4f96-82d3-7bb4ba9c317e"; ## SECRET-DATA
                ssh-rsa "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDGSZXWQbRESKnHPyBrRFLz8pr+e7clzic0wjJFx2DC06bIaR1CqmxHQUKvuzUfmAedkrMcGw+wWNizYOlPFzWrHCNXpyzx2+Sr9ZUlk27UPfMI6XuB1GZ34ielCCLHt40eU4E1cdy4wnIZ3nxfL7vb6hxzFcC8/giRrujJBK87iSAoByaB9lulNvdHokRNnTP6mCJquOtGdaUTrqUqTr8sueEJTt8ehotdNSlrDreeHODZtB2sgQpmGNzQ2zEFskCqoZl9lgL8IlR/0NSvkOBPAOiikeemDzW3KpLdvXoXUvmMaZPkB0zpS7/T/gMtYLxZ51qO49PKVBvBXr+a3nIkJe1403J80lvmOwVbdO8bvywV6mNpjXe2J0m2Cm+LV7kdD1lZKhih4/DEvBJ4rkfZN/t+rxqms59EpTCkKSb/+N3j/q1OKfXY8o2VEvSkTn1Ag8UNiq1kh84F7CC00UtEbpBAV/Z/AOCaVrdzm3595+9oL2GsXP0i5cPx2ylaFzJW0hB4OerU4DzQ4n/2C8Oq4v/sgBPwjW4YRFmaidoQr2blcoqf916dRsmQR5G1Uc1g3ps+ph5BdjUiZgPvxCTCPIOzNsTbu888UDgnBBF1YeeGXRmfkwQobu8eWfjm+HI0H8/rSfIPDBrjI3hZsHcN0ZYKyzMwkWVmAdjuCaYsWw== noninteractive@mistsys.com"; ## SECRET-DATA
                ssh-ecdsa "ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBItBz6WSD+YBbvX2qvKlLQ71h2qms2A5ARsFQK7GQSiBbh6450VcCNNq6YDmb1/pOrrJ8q7cR90vsvNROi4ZD7I= bot+interactive@mistsys.com"; ## SECRET-DATA
            }
        }
    }
    services {
        ssh {
            root-login allow;
            protocol-version v2;
            sftp-server;
        }
        extension-service {
            request-response {
                grpc {
                    clear-text {
                        port 32767;
                    }
                }
            }
        }
        netconf {
            ssh;
        }
        outbound-ssh {
            traceoptions {
                file outbound-ssh.log size 64k files 5;
                flag all;
            }
            client mist {
                device-id 2a10e8b3-060c-4f96-82d3-7bb4ba9c317e.2c6bf539b200;
                secret "$9$g64Di5QFCp0JGApO1hclKML-VgoJGjH4o369tOBwY2goGDik.5QdboGUjq.0B1RreWLxsgoXxik.fzFlKvLdbwYgaJDrevLxNbwaZUimfzF/uBIDikPfT/9O1REreXxdVYgXx-w24ZG/CAtBIEhreM81IVw2gJZ36/9O1revNVweK24JZjiCtpOhSMWxw24-d5QznCAKMWxVw24aiHmX7P5TQn6M8L7bs2gJji.g4n/tpREwY2aJDiHmQz6HkApB1hcKM8X7Vg4ZGikWLVY24ZGn/9A1RcylvMXhceW8xdV24aZGimfT6/t24QFn/0O1RhrWLX7-ws4BIwY4oGU69CtIEeK8L7-CtLxNVY2P5T3Ct1Ic"; ## SECRET-DATA
                keep-alive {
                    retry 12;
                    timeout 5;
                }
                services netconf;
                oc-term.mistsys.net {
                    port 2200;
                    retry 1000;
                    timeout 60;
                }
            }
        }
    }
    time-zone UTC;
    authentication-order password;
    syslog {
        user * {
            any emergency;
        }
        file escript.log {
            archive size 2m files 5;
        }
        file interactive-commands {
            interactive-commands any;
            match "!(.*mist.*)";
            archive size 2m files 5;
        }
        file messages {
            any notice;
            authorization any;
            archive size 2m files 5;
        }
        file op-script.log {
            archive size 2m files 5;
        }
        file snapshot {
            archive size 2m files 5;
        }
    }
}
chassis {
    network-services enhanced-ip;
    evpn-vxlan-default-switch-support;
}
interfaces {
    interface-range evpn_uplink {
        member ge-0/0/0;
        member ge-0/0/1;
        apply-groups evpn_uplink;
    }
    interface-range vlan101 {
        member ge-0/0/2;
        member ge-0/0/3;
        apply-groups vlan101;
    }
    ge-0/0/0 {
        description evpn_uplink-to-2c6bf5265000;
        unit 0 {
            family inet {
                address 10.255.240.11/31;
            }
        }
    }
    ge-0/0/1 {
        description evpn_uplink-to-2c6bf5a78500;
        unit 0 {
            family inet {
                address 10.255.240.19/31;
            }
        }
    }
    fxp0 {
        unit 0 {
            family inet {
                dhcp {
                    client-identifier {
                        user-id ascii 2c6bf539b200-JirbwxaW;
                    }
                    retransmission-attempt 60;
                    vendor-id Juniper;
                    force-discover;
                }
            }
        }
    }
    irb {
        unit 0 {
            description default;
            family inet {
                dhcp {
                    client-identifier {
                        user-id ascii 2c6bf539b200-0;
                    }
                    retransmission-attempt 60;
                    vendor-id Juniper;
                    force-discover;
                }
                mtu 9000;
            }
            no-dhcp-flood;
        }
        unit 101 {
            description vlan101;
            family inet {
                mtu 9000;
                address 192.168.101.1/24;
            }
            mac 00:00:5e:e4:31:57;
            no-dhcp-flood;
        }
    }
}
routing-options {
    static {
        route 0.0.0.0/0 {
            next-hop [ 172.16.254.1 172.16.254.2 172.16.254.3 172.16.254.4 ];
            resolve;
        }
    }
    forwarding-table {
        ##
        ## Warning: statement ignored: unsupported platform (ex9214)
        ##
        ecmp-fast-reroute;
        chained-composite-next-hop {
            ingress {
                evpn;
            }
        }
    }
}
protocols {
    ##
    ## Warning: requires 'bgp' license
    ##
    bgp {
        group evpn_underlay {
            type external;
            log-updown;
            import evpn_underlay_import;
            family inet {
                unicast;
            }
            authentication-key "$9$yNYleWXxdb24x7jHkqf569A0OREcyvMXEh4aJGq.EcSrlM7-Vb24VboGUi.mRhcyWLbs2oZUbwTz36u07-dbgoUDkm5QkqQn9A1I7-dsaZDjqzn/s2n/CtOBRhSr8Xbs2ZGiwsJDjkPfO1IRylKvLdwY7Nik.mTQ9ApuEcWLxbwgIEs24aUDHqmfFn"; ## SECRET-DATA
            export evpn_underlay_export;
            local-as 65005;
            multipath {
                multiple-as;
            }
            bfd-liveness-detection {
                minimum-interval 350;
                multiplier 3;
            }
            neighbor 10.255.240.10 {
                peer-as 65003;
            }
            neighbor 10.255.240.18 {
                peer-as 65004;
            }
        }
        group evpn_overlay {
            type external;
            multihop {
                ttl 1;
                no-nexthop-change;
            }
            local-address 172.16.254.5;
            log-updown;
            family evpn {
                signaling {
                    loops 2;
                }
            }
            authentication-key "$9$yNYleWXxdb24x7jHkqf569A0OREcyvMXEh4aJGq.EcSrlM7-Vb24VboGUi.mRhcyWLbs2oZUbwTz36u07-dbgoUDkm5QkqQn9A1I7-dsaZDjqzn/s2n/CtOBRhSr8Xbs2ZGiwsJDjkPfO1IRylKvLdwY7Nik.mTQ9ApuEcWLxbwgIEs24aUDHqmfFn"; ## SECRET-DATA
            local-as 65005;
            multipath {
                multiple-as;
            }
            bfd-liveness-detection {
                minimum-interval 1000;
                multiplier 3;
                session-mode automatic;
            }
            neighbor 172.16.254.3 {
                peer-as 65003;
            }
            neighbor 172.16.254.4 {
                peer-as 65004;
            }
        }
        graceful-restart;
    }
    lldp {
        port-id-subtype interface-name;
        port-description-type interface-alias;
        interface all;
    }
    lldp-med {
        interface all;
    }
}
vlans {
    default {
        vlan-id 1;
        l3-interface irb.0;
    }
}
